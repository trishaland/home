<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sapi Terbang - TrishaLand</title>
  <link rel="icon" type="image/png" href="TrishaLand.webp">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;700&display=swap" rel="stylesheet">

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: "Poppins", sans-serif;
      background:#fff;
      color:#000;
      min-height:100vh;
      display:flex;
      flex-direction:column;
      overflow-x:hidden;
    }

    /* HEADER (ambil dari About Trisha) */
    header {
      position: fixed; top: 0; left: 0;
      width: 100%;
      background: rgba(173, 216, 230, 0.8);
      backdrop-filter: blur(8px);
      padding: 15px 20px;
      display: flex; justify-content: space-between; align-items: center;
      z-index: 1000;
      height: 60px;
    }

    .logo { display: flex; align-items: center; gap: 10px; }
    .logo-img { width: 55px; height: auto; object-fit: contain; }
    .logo-text { display: flex; flex-direction: column; line-height: 1.2; }
    .logo-main { font-size: 22px; font-weight: 600; color: #004080; }
    .logo-sub { font-size: 12px; color: #333; }

    .mobile-logo {
      display: none;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }
    .mobile-logo img { width: 150px; height: auto; object-fit: contain; }

    nav ul { list-style: none; display: flex; gap: 25px; }
    nav ul li a {
      text-decoration: none; color: #000; font-weight: 400; transition: 0.3s;
    }
    nav ul li a:hover { color: #004080; }
    .hamburger { display: none; flex-direction: column; cursor: pointer; gap: 5px; transition: all 0.3s ease; }
    .hamburger span { width: 25px; height: 3px; background: #000; border-radius: 5px; transition: all 0.3s ease; }

    .hamburger.active span:nth-child(1) { transform: rotate(45deg) translateY(8px); }
    .hamburger.active span:nth-child(2) { opacity: 0; }
    .hamburger.active span:nth-child(3) { transform: rotate(-45deg) translateY(-8px); }

    @media (max-width: 768px) {
      .logo { display: none; }
      .mobile-logo { display: block; }
      nav ul {
        display: none;
        position: absolute;
        top: 60px; right: 20px;
        background: #add8e6;
        flex-direction: column; gap: 15px;
        padding: 20px; border-radius: 10px;
      }
      nav ul.active { display: flex; }
      .hamburger { display: flex; }
    }

    /* ==== MAIN (pusatkan game) ==== */
    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding-top: 80px;
      padding-bottom: 60px;
      background: linear-gradient(180deg,#e6f8ff 0%, #ffffff 100%);
    }

    #startScreen {
      width:100%;
      max-width:1000px;
      min-height: 70vh;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      text-align:center;
      background:#ffffff;
      padding: 30px;
      border-radius: 12px;
      margin: auto;
    }

    #startScreen h1 { font-size:28px; color:#004080; margin-bottom:16px; }

    .char-select { display:flex; gap:18px; flex-wrap:wrap; justify-content:center; }
    .char-select img {
      width:110px; height:110px; object-fit:cover; border-radius:12px;
      border:3px solid transparent; cursor:pointer;
      transition: transform .15s, border-color .15s;
    }
    .char-select img:hover { transform:scale(1.06); border-color:#004080; }

    .game-wrapper {
      width:90vw; max-width:900px;
      aspect-ratio: 3 / 2;
      border:2px solid #000;
      border-radius:10px;
      overflow:hidden;
      position:relative;
      background:#bfeeff;
      display:none;
      margin:auto;
    }

    @media (max-width:600px) {
      #startScreen h1 { font-size:22px; }
      .char-select img { width:90px; height:90px; }
      main { padding-top: 70px; }
    }

    #gameCanvas { width:100%; height:100%; display:block; }
    #gameOverGif, #deathMessage, #overlayRestart {
      position:absolute; left:50%; transform:translateX(-50%);
      z-index:20;
    }
    #gameOverGif { top:10%; width:90px; display:none; pointer-events:auto; }
    #deathMessage {
      top:54%;
      transform:translate(-50%,-50%);
      display:none;
      font-size: clamp(16px, 2.4vw, 26px);
      color:#fff; font-weight:700; text-align:center;
      text-shadow: 0 2px 6px rgba(0,0,0,0.6);
    }
    #overlayRestart { bottom:10%; display:none; }
    #overlayRestart button {
      padding:10px 18px;
      font-size: clamp(14px, 1.6vw, 18px);
      background:#ff4444; color:#fff; border:none; border-radius:10px;
      cursor:pointer;
    }
    #overlayRestart button:hover { background:#cc0000; }

    .modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); align-items:center; justify-content:center; z-index:2000; }
    .modal .card { background:#111; color:#fff; padding:22px; border-radius:12px; text-align:center; width:90%; max-width:420px; }

    /* FOOTER */
    .footer {
      background: #004080;
      color: white;
      padding: 50px 20px 20px;
      margin-top: auto;
    }
    .footer-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      max-width: 1200px;
      margin: 0 auto;
      gap: 30px;
    }
    .footer-column { flex: 1; min-width: 200px; }
    .footer-column h3 {
      font-size: 1.2rem;
      margin-bottom: 15px;
      color: #ffdd57;
    }
    .footer-column ul { list-style: none; padding: 0; }
    .footer-column ul li { margin-bottom: 10px; }
    .footer-column ul li a {
      text-decoration: none; color: white; transition: color 0.3s;
    }
    .footer-column ul li a:hover { color: #ffdd57; }
    .footer-bottom {
      text-align: center;
      margin-top: 30px;
      font-size: 0.9rem;
      border-top: 1px solid rgba(255,255,255,0.2);
      padding-top: 15px;
    }
  </style>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const hamburger = document.querySelector(".hamburger");
      const navMenu = document.querySelector("nav ul");
      if (hamburger && navMenu) {
        hamburger.addEventListener("click", () => {
          navMenu.classList.toggle("active");
          hamburger.classList.toggle("active");
        });
      }
    });
  </script>
</head>

<body>

  <!-- HEADER -->
  <header>
    <div class="logo">
      <img src="TrishaLand.webp" alt="Logo TrishaLand" class="logo-img">
      <div class="logo-text">
        <div class="logo-main">Trishaland</div>
        <div class="logo-sub">Fansite Trisha JKT48</div>
      </div>
    </div>

    <div class="mobile-logo">
      <img src="TrishaLandMobile.webp" alt="Logo TrishaLand Mobile">
    </div>

    <nav>
      <ul>
        <li><a href="index.html">HOME</a></li>
        <li><a href="about.html">ABOUT TRISHA</a></li>
        <li><a href="corner.html"style="color:#ffffff;">CORNER</a></li>
      </ul>
    </nav>

    <div class="hamburger">
      <span></span><span></span><span></span>
    </div>
  </header>

  <!-- ==== MAIN CONTENT (Game) ==== -->
  <main>
    <section id="startScreen">
      <h1>Pilih Karakter Sapi üêÑ‚ú®</h1>
      <div class="char-select">
        <img src="cover_sapi1.jpg" data-sprite="sapi1.png" alt="sapi1">
        <img src="cover_sapi2.jpg" data-sprite="sapi2.png" alt="sapi2">
        <img src="cover_sapi3.jpg" data-sprite="sapi3.png" alt="sapi3">
        <img src="cover_sapi4.jpg" data-sprite="sapi4.png" alt="sapi4">
      </div>
      <p style="margin-top:18px; color:#333; font-size:14px;">Klik karakter untuk mulai ‚Äî Tap layar untuk meloncat.</p>
    </section>

    <div class="game-wrapper" id="gameWrapper">
      <canvas id="gameCanvas"></canvas>
      <img id="gameOverGif" src="over.gif" alt="Game Over GIF" />
      <div id="deathMessage"></div>
      <div id="overlayRestart"><button id="restartBtn">üîÑ Restart</button></div>
    </div>

    <div id="winModal" class="modal">
      <div class="card">
        <h2>üéâ Selamat! üéâ</h2>
        <p>Kamu berhasil nangkep 10 balon buat Trisha! üéàüêÑ‚ú®</p>
        <button id="closeWinBtn" style="margin-top:12px;padding:10px 16px;border-radius:8px;border:none;background:#44aa44;color:#fff;cursor:pointer;">OK</button>
      </div>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-column">
        <h3>Halaman</h3>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About Trisha</a></li>
          <li><a href="corner.html">Corner</a></li>
        </ul>
      </div>

      <div class="footer-column">
        <h3>Sosial Media Trisha</h3>
        <ul>
          <li><a href="https://www.instagram.com/jkt48.trisha/" target="_blank">Instagram</a></li>
          <li><a href="https://www.threads.com/@jkt48.trisha" target="_blank">Threads</a></li>
          <li><a href="https://x.com/JTrisha_JKT48" target="_blank">X / Twitter</a></li>
          <li><a href="https://www.tiktok.com/@jkt48.trisha" target="_blank">TikTok</a></li>
          <li><a href="https://www.idn.app/jkt48_trisha" target="_blank">IDN App</a></li>
          <li><a href="https://www.showroom-live.com/r/JKT48_Trisha" target="_blank">Showroom</a></li>
        </ul>
      </div>

      <div class="footer-column">
        <h3>Hashtag</h3>
        <ul>
          <li>#TrishAfternoon</li>
          <li>#TrishArt</li>
          <li>#Trishartuday</li>
          <li>#WannaSeeTrisha</li>
          <li>#Trishaur</li>
          <li>#Trishelca</li>
        </ul>
      </div>
    </div>

    <div class="footer-bottom">
      ¬© 2025 Trishaland. All rights reserved.
    </div>
  </footer>

  <script>
    const startScreen = document.getElementById('startScreen');
    const gameWrapper = document.getElementById('gameWrapper');
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const gameOverGif = document.getElementById('gameOverGif');
    const deathMessage = document.getElementById('deathMessage');
    const overlayRestart = document.getElementById('overlayRestart');
    const restartBtn = document.getElementById('restartBtn');
    const winModal = document.getElementById('winModal');
    const closeWinBtn = document.getElementById('closeWinBtn');

    const bgImg = new Image(); bgImg.src = 'background.png';
    const bgm = new Audio('backsound.mp3');
    const loseSfx = new Audio('lose.mp3');
    const winSfx = new Audio('win.mp3');
    const cowSfx = new Audio('moo.mp3');
    bgm.loop = true; bgm.volume = 0.45; cowSfx.volume = 0.6;

    let WIDTH = 600, HEIGHT = 400;
    let sprite = new Image();
    let frameW = 64, frameH = 64, currentFrame = 0;
    let cow, pipes, balloons, score, gameOver, finished, gameLoopId;
    let hasClickedOnce = false;
    const TARGET = 10;
    let cowSfxInterval = null;
    let deathReason = '';

    sprite.onload = () => {
      frameW = sprite.width / 4; // üü¢ otomatis 4 frame horizontal
      frameH = sprite.height;
    };

    function resizeCanvasToWrapper() {
      const style = getComputedStyle(gameWrapper);
      const w = parseFloat(style.width);
      const h = parseFloat(style.height);
      const dpr = window.devicePixelRatio || 1;
      canvas.width = Math.round(w * dpr);
      canvas.height = Math.round(h * dpr);
      canvas.style.width = w + 'px';
      canvas.style.height = h + 'px';
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      WIDTH = w; HEIGHT = h;
    }

    function resetGameState() {
      cancelAnimationFrame(gameLoopId);
      resizeCanvasToWrapper();
      const scale = WIDTH / 600;
      cow = { x: WIDTH * 0.18, y: HEIGHT / 2, w: frameW * scale, h: frameH * scale, vel: 0, gravity: 0.6 * scale, lift: -10 * scale, tick: 0 };
      pipes = [];
      balloons = [];
      score = 0;
      gameOver = false;
      finished = false;
      hasClickedOnce = false;
      deathReason = '';
      gameOverGif.style.display = 'none';
      deathMessage.style.display = 'none';
      overlayRestart.style.display = 'none';
      if (cowSfxInterval) clearInterval(cowSfxInterval);
      cowSfxInterval = setInterval(()=> { try { cowSfx.cloneNode(true).play(); } catch(e){} }, 4000);
    }

    function spawnPipe() {
      const gap = Math.max(HEIGHT * 0.18, 80) * 2.7;
      const top = Math.random() * (HEIGHT - gap - 60) + 30;
      pipes.push({ x: WIDTH + 10, y: top, gap });
      balloons.push({ x: WIDTH + 50, y: top + gap / 2, size: Math.max(20, Math.floor(24 * (WIDTH/600))), collected: false });
    }

    function update() {
      if (!hasClickedOnce || gameOver || finished) return;
      cow.vel += cow.gravity;
      cow.y += cow.vel;
      if (cow.y + cow.h >= HEIGHT) { deathReason = 'fall'; endGame(); }
      if (cow.y < 0) cow.y = 0;

      cow.tick++;
      if (cow.tick % 6 === 0) currentFrame = (currentFrame + 1) % 4; // animasi halus

      const speed = 2.5 * (WIDTH / 600);
      pipes.forEach(p => p.x -= speed);
      balloons.forEach(b => b.x -= speed);

      for (let p of pipes) {
        if (cow.x < p.x + 100 && cow.x + cow.w > p.x) {
          if (cow.y < p.y || cow.y + cow.h > p.y + p.gap) {
            deathReason = 'hit'; endGame(); break;
          }
        }
      }

      for (let b of balloons) {
        if (!b.collected) {
          const bx = b.x, by = b.y, bs = b.size;
          if (cow.x < bx + bs && cow.x + cow.w > bx - bs && cow.y < by + bs && cow.y + cow.h > by - bs) {
            b.collected = true; score++;
            if (score >= TARGET) finishGame();
          }
        }
      }

      pipes = pipes.filter(p => p.x + 100 > -50);
      balloons = balloons.filter(b => b.x + b.size > -50);

      if (pipes.length === 0 || pipes[pipes.length - 1].x < WIDTH - 400) spawnPipe();
    }

    function draw() {
      ctx.clearRect(0,0,WIDTH,HEIGHT);
      if (bgImg.complete) ctx.drawImage(bgImg, 0, 0, WIDTH, HEIGHT);
      else { ctx.fillStyle = '#87CEEB'; ctx.fillRect(0,0,WIDTH,HEIGHT); }

      ctx.fillStyle = 'green';
      pipes.forEach(p => {
        ctx.fillRect(p.x, 0, 100, p.y);
        ctx.fillRect(p.x, p.y + p.gap, 100, HEIGHT - (p.y + p.gap));
      });

      balloons.forEach(b => {
        if (!b.collected) {
          ctx.font = `${b.size}px serif`;
          ctx.textAlign = 'center';
          ctx.fillText('üéà', b.x, b.y);
        }
      });

      if (sprite && sprite.src) {
        ctx.drawImage(
          sprite,
          frameW * currentFrame, 0,
          frameW, frameH,
          cow.x, cow.y, cow.w, cow.h
        );
      } else {
        ctx.fillStyle = '#fff';
        ctx.fillRect(cow.x, cow.y, cow.w, cow.h);
      }

      ctx.fillStyle = '#000';
      ctx.font = `${Math.max(14, 18 * (WIDTH/600))}px Poppins, Arial`;
      ctx.fillText('Score: ' + score, 112, 26);
    }

    function gameLoop() {
      update();
      draw();
      if (!gameOver && !finished) gameLoopId = requestAnimationFrame(gameLoop);
    }

    function showGameOverOverlays() {
      gameOverGif.style.display = 'block';
      deathMessage.style.display = 'block';
      deathMessage.textContent = deathReason === 'fall' ? 'Dedek Trisha Jatuh ü•∫' : 'Dedek Trisha Ketabrak ü•∫';
      overlayRestart.style.display = 'block';
      overlayRestart.querySelector('button').focus();
    }

    function endGame() {
      if (gameOver) return;
      gameOver = true;
      try { bgm.pause(); } catch(e){}
      try { loseSfx.cloneNode(true).play(); } catch(e){}
      if (cowSfxInterval) clearInterval(cowSfxInterval);
      showGameOverOverlays();
    }

    function finishGame() {
      finished = true; gameOver = true;
      if (cowSfxInterval) clearInterval(cowSfxInterval);
      try { bgm.pause(); } catch(e){}
      try { winSfx.play(); } catch(e){}
      winModal.style.display = 'flex';
    }

    document.querySelectorAll('.char-select img').forEach(img => {
      img.addEventListener('click', () => {
        sprite.src = img.getAttribute('data-sprite');
        startScreen.style.display = 'none';
        gameWrapper.style.display = 'block';
        resizeCanvasToWrapper();
        resetGameState();
        try { bgm.currentTime = 0; bgm.play(); } catch(e){}
        gameLoop();
      });
    });

    canvas.addEventListener('click', () => {
      if (gameOver || finished) return;
      hasClickedOnce = true;
      cow.vel = cow.lift;
    });

    window.addEventListener('keydown', e => {
      if (e.code === 'Space') {
        e.preventDefault();
        if (!gameOver && !finished) { hasClickedOnce = true; cow.vel = cow.lift; }
      }
    });

    restartBtn.addEventListener('click', () => {
      winModal.style.display = 'none';
      startScreen.style.display = 'flex';
      gameWrapper.style.display = 'none';
      overlayRestart.style.display = 'none';
      gameOverGif.style.display = 'none';
      deathMessage.style.display = 'none';
      try { bgm.pause(); bgm.currentTime = 0; } catch(e){}
    });

    closeWinBtn.addEventListener('click', () => {
      winModal.style.display = 'none';
      startScreen.style.display = 'flex';
      gameWrapper.style.display = 'none';
    });

    window.addEventListener('resize', () => resizeCanvasToWrapper());
  </script>
</body>
</html>
